{"version":3,"file":"navigation-lazy.min.js","sources":["../src/navigation-lazy.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Open Educational Resources Plugin\n *\n * @author     Christian Ortner <christian.ortner@tugraz.at>\n * @copyright  2022 Educational Technologies, Graz, University of Technology\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as UserPreference from 'local_oer/userpreferences-lazy';\nimport * as Output from 'local_oer/output-lazy';\nimport * as Str from 'core/str';\n\n/**\n * Add listener for layout menu.\n */\nexport const initLayoutListener = () => {\n    const element = document.getElementById(\"local_oer-select-layout\");\n    if (element === null) {\n        return;\n    }\n\n    element.addEventListener(\"click\", (action) => {\n        action.preventDefault();\n        UserPreference.setLayout(action.target.dataset.value);\n        Output.showFiles(false, true);\n    });\n};\n\n/**\n * Add listener for sort menu.\n */\nexport const initSortListener = () => {\n    const element = document.getElementById(\"local_oer-sort-files\");\n    if (element === null) {\n        return;\n    }\n\n    element.addEventListener(\"click\", (action) => {\n        action.preventDefault();\n        UserPreference.setSort(action.target.dataset.value);\n        Output.showFiles(false, true);\n    });\n};\n\n/**\n * Add listener for filter menu.\n */\nexport const initGroupingListener = () => {\n    const element = document.getElementById(\"local_oer-select-grouping\");\n    if (element === null) {\n        return;\n    }\n\n    element.addEventListener(\"click\", (action) => {\n        action.preventDefault();\n        if (typeof action.target.dataset.value === 'undefined') {\n            return;\n        }\n        let filtervalue = action.target.dataset.filtervalue;\n        UserPreference.setFilter(action.target.dataset.value, filtervalue);\n        Output.showFiles(false, true);\n    });\n};\n\n/**\n * Add listener for courseinfo button.\n */\nexport const initCourseinfoListener = () => {\n    const element = document.getElementById(\"local_oer_courseinfo_button\");\n    if (element === null) {\n        return;\n    }\n    // eslint-disable-next-line space-before-function-paren\n    element.addEventListener(\"click\", async (action) => {\n        action.preventDefault();\n        const title = await Str.get_string('courseinfobutton', 'local_oer');\n        Output.showForm('CourseinfoForm', title, {});\n    });\n};\n\n/**\n * Add listener for preference button.\n */\nexport const initPreferenceListener = () => {\n    const element = document.getElementById(\"local_oer_preference_button\");\n    if (element === null) {\n        return;\n    }\n    // eslint-disable-next-line space-before-function-paren\n    element.addEventListener(\"click\", async (action) => {\n        action.preventDefault();\n        const title = await Str.get_string('preferencebutton', 'local_oer');\n        Output.showForm('PreferenceForm', title, {});\n    });\n};\n\n/**\n * Add listener for text search field.\n */\nexport const initSearchListener = () => {\n    const searchInput = document.getElementById('local_oer_searchFilecardsInput');\n    if (searchInput === null) {\n        return;\n    }\n    const searchFiles = debounce(() => {\n        Output.showFiles(false, true);\n    }, 500, false);\n\n    searchInput.addEventListener(\"keyup\", searchFiles);\n    searchInput.addEventListener(\"search\", () => {\n        Output.showFiles(false, true);\n    });\n};\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * Taken from https://davidwalsh.name/javascript-debounce-function\n *\n * @param {function} func\n * @param {int} wait\n * @param {boolean} immediate\n * @returns {(function(): void)|*}\n */\nconst debounce = (func, wait, immediate) => {\n    let timeout;\n    return function() {\n        const context = this;\n        const args = arguments;\n        const later = function() {\n            timeout = null;\n            if (!immediate) {\n                func.apply(context, args);\n            }\n        };\n        const callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) {\n            func.apply(context, args);\n        }\n    };\n};"],"names":["element","document","getElementById","addEventListener","action","preventDefault","UserPreference","setLayout","target","dataset","value","Output","showFiles","setSort","filtervalue","setFilter","async","title","Str","get_string","showForm","searchInput","searchFiles","debounce","func","wait","immediate","timeout","context","this","args","arguments","later","apply","callNow","clearTimeout","setTimeout"],"mappings":";;;;;;;+YA8BkC,WACxBA,QAAUC,SAASC,eAAe,2BACxB,OAAZF,SAIJA,QAAQG,iBAAiB,SAAUC,SAC/BA,OAAOC,iBACPC,eAAeC,UAAUH,OAAOI,OAAOC,QAAQC,OAC/CC,OAAOC,WAAU,GAAO,iCAOA,WACtBZ,QAAUC,SAASC,eAAe,wBACxB,OAAZF,SAIJA,QAAQG,iBAAiB,SAAUC,SAC/BA,OAAOC,iBACPC,eAAeO,QAAQT,OAAOI,OAAOC,QAAQC,OAC7CC,OAAOC,WAAU,GAAO,qCAOI,WAC1BZ,QAAUC,SAASC,eAAe,6BACxB,OAAZF,SAIJA,QAAQG,iBAAiB,SAAUC,YAC/BA,OAAOC,sBACoC,IAAhCD,OAAOI,OAAOC,QAAQC,iBAG7BI,YAAcV,OAAOI,OAAOC,QAAQK,YACxCR,eAAeS,UAAUX,OAAOI,OAAOC,QAAQC,MAAOI,aACtDH,OAAOC,WAAU,GAAO,uCAOM,WAC5BZ,QAAUC,SAASC,eAAe,+BACxB,OAAZF,SAIJA,QAAQG,iBAAiB,SAASa,MAAAA,SAC9BZ,OAAOC,uBACDY,YAAcC,IAAIC,WAAW,mBAAoB,aACvDR,OAAOS,SAAS,iBAAkBH,MAAO,wCAOX,WAC5BjB,QAAUC,SAASC,eAAe,+BACxB,OAAZF,SAIJA,QAAQG,iBAAiB,SAASa,MAAAA,SAC9BZ,OAAOC,uBACDY,YAAcC,IAAIC,WAAW,mBAAoB,aACvDR,OAAOS,SAAS,iBAAkBH,MAAO,oCAOf,WACxBI,YAAcpB,SAASC,eAAe,qCACxB,OAAhBmB,yBAGEC,YAAcC,UAAS,KACzBZ,OAAOC,WAAU,GAAO,KACzB,KAAK,GAERS,YAAYlB,iBAAiB,QAASmB,aACtCD,YAAYlB,iBAAiB,UAAU,KACnCQ,OAAOC,WAAU,GAAO,aAgB1BW,SAAW,CAACC,KAAMC,KAAMC,iBACtBC,eACG,iBACGC,QAAUC,KACVC,KAAOC,UACPC,MAAQ,WACVL,QAAU,KACLD,WACDF,KAAKS,MAAML,QAASE,OAGtBI,QAAUR,YAAcC,QAC9BQ,aAAaR,SACbA,QAAUS,WAAWJ,MAAOP,MACxBS,SACAV,KAAKS,MAAML,QAASE"}